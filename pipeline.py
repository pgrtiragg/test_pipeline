import pandas as pd
import sqlite3
from sqlalchemy import create_engine

engine=create_engine("postgresql://vcm.uaem:jkSEhOfenA19@ep-yellow-bird-89299762.us-east-2.aws.neon.tech/stats?sslmode=require")
#conn = sqlite3.connect('stats2024.db')
df={}
headers={
    'familia':['fecha','nombre_de_la_persona_solicitante','sexo_solicitante','edad_solicitante','orientación_sexual_solicitante','discapacidad_solicitante','nacionalidad_solicitante','procedencia_solicitante','etnia_solicitante','asesoría','tipo_de_expediente','n_expediente','fase','procesos','subprocesos','seguimiento_de_solicitudes_con_cita','seguimiento_de_solicitudes_sin_cita','conciliaciones_programadas','conciliaciones_realizadas','convenios','fecha_de_recepción_de_pruebas_a_entregar','¿entregó_prueba?','resoluciones_administrativas','recursos_en_fase_administrativa','n_de_oficio_o_n_de_expediente','fijaciones_en_instancias_judiciales','monto_de_cuota_judicial','amortización_de_mora_judicial','fijación_de_cuota','modalidad_de_pago','monto_de_cuota_provisional','monto_de_cuota_fijada_en_sede_administrativa','amortización_de_mora_administrativa','total_de_cuotas_fijadas_(judicial_y_administrativa)','asignación_de_expedientes_en_fase_judicial','calificación_de_prueba_en_fase_judicial','fecha_de_presentación_de_caso_en_fase_judicial','presentación_de_casos_en_fase_judicial','si_hubo_admisión','no_hubo_admisión','prevención_de_admisiones','recursos_de_admisones','audiencias_judiciales_programadas','audiencias_judiciales_asistidas','aviso_ucft','diligencias_finalizadas','resultado_del_expediente_finalizado','conclusión_del_expediente_en_actas','conclusión_del_expediente_en_resoluciones','conclusión_del_expediente_en_certificación_de_expediente_a_fgr','conclusión_del_expediente_en_dejar_sin_efecto','conclusión_del_expediente_que_han_sido_inadmisible','conclusión_del_expediente_que_han_sido_improponible','conclusión_del_expediente_que_han_sido_sentencia_definitiva','otros','sexo_indirectos','edad_indirectos','orientación_sexual_indirectos','discapacidad_indirectos','nacionalidad_indirectos','procedencia_indirectos','etnia_indirectos','mes','pad'],
    'nna':['fecha','tipo_de_solicitud','nombre_de_la_persona_o_institución_solicitante','asesoría/derivaciones','tipo_de_expediente','n_expediente','sexo_solicitante','edad_solicitante','orientación_sexual_solicitante','discapacidad_solicitante','nacionalidad_solicitante','etnia_solicitante','etapa','proceso','subproceso','sexo_indirecto','edad_indirecto','orientación_sexual_indirecto','discapacidad_indirecto','nacionalidad_indirecto','etnia_indirecto','expedientes_finalizados','resultado','montos','mes','pad'],
    'mediacion':['fecha_de_atención','municipio','procedencia','servicios_brindados','derivaciones','casos_antiguos','casos_nuevos','naturaleza_y_tipología','naturaleza_familiar','naturaleza_de_niñez_y_adolescencia','naturaleza_patrimonial','naturaleza_de_convivencia','naturaleza_comunitario','naturaleza_laboral','naturaleza_de_discriminación','naturaleza_escolar','sexo_solicitante','edad_solicitante','orientación_sexual_solicitante','discapacidad_solicitante','etnia_solicitante','nacionalidad_solicitante','estado_familiar_solicitante','nivel_educativo_solicitante','sexo_convocado','edad_convocado','orientación_sexual_convocado','persona_con_discapacidad_convocado','etnia_convocado','nacionalidad_convocado','estado_familiar_convocado','nivel_educativo_convocado','sexo_indirecto','edad_indirecto','orientación_sexual_indirecto','discapacidad_indirecto','etnia_indirecto','nacionalidad_indirecto','programación_de_mediación','mediación_instalada','sesiones_realizadas_por_casos_mediados','resultados_con_acuerdo','resultados_sin_acuerdo','mediaciones_suspendidas','convocatoria_realizada_no_mediada','motivos_de_no_realización_de_la_mediación','desistimiento_del_solicitante','instalación_de_mediación_caso_de_seguimiento','atención_de_seguimiento_a_mediación','reapertura','con_acuerdo_casos_de_seguimientos','sin_acuerdo_casos_de_seguimientos','supendidas_por_de_casos_de_seguimiento','motivos_de_no_realización_de_la_mediación_de_seguimiento','montos_acordados','expedientes_finalizados','mes','pad'],
    'uaem':['n_de_expediente','atención_digital','atención_presencial','tipo_de_expedientes','edad_solicitante','procedencia_solicitante','discapacidad_solicitante','orientación_sexual_solicitante','etnia_solicitante','nacionalidad_solicitante','embarazo','nivel_académico_solicitante','tipología_de_caso_intrafamiliar','tipología_de_caso_de_delitos','tipología_de_caso_de_discriminación','tipología_de_casos_de_acciones_positivas','tipología_de_casos_derivación_penal','tipología_de_casos_de_grupo_de_autoayuda','asesorías_legales','asesorías_psicológicas','asesorías_sociales','modalidad_de_violencia','violencia_física','violencia_psicológica_y_emocional','violencia_económica','violencia_patrimonial','violencia_sexual','violencia_simbólica','violencia_feminicida','acompañamiento_legal','entrevista_a_mujer_detenida','representación_legal','recursos_legales','entrevista_de_testigos_legales','preparación_de_prueba_legales','solicitud_de_repación_del_daño_legales','monto_fijado_en_concepto_de_reparación','monto_fijado_en_concepto_de_cuota_alimenticia','resultado_favorable','resultado_desfavorable','informes_legales','reportes_legales','primeros_auxilios_psicológicos_area_legal','otras_diligencias_legales','número_de_audiencias_realizadas','derivación_area_legal','toma_de_denuncia_area_legal','solicitud_de_medidas_area_legal','solicitu_a_hijos_e_hijas_de_cuota_alimenticia_area_legal','solicitud_de_cuota_alimenticia_a_persona_adulta_mayor_area_legal','solicitud_de_cuota_alimenticia_a_usuaria_area_legal','red_de_apoyo_area_legal','búsqueda_de_albergue_area_legal','vi_certificados_en_fgr','judicialización_de_certificación_a_fgr','seguimientos_presenciales_legales','seguimientos_virtuales_legales','atención_en_crisis_psicologicas','entrevista_a_mujer_detenida_area_psicologica','número_de_sesiones_presenciales','número_de_sesiones_virtuales','primera_entrevista_psicologica','atención_psicológica','acompañamiento_psicologico','primeros_auxilios_psicológicos','monitoreo_de_medidas_psicologicos','informes_psicologicos','reportes_psicologicos','derivación_area_psicologica','toma_de_denuncia_area_psicologica','solicitud_de_medidas_area_psicologica','solicitu_a_hijos_e_hijas_de_cuota_alimenticia_area_psicologica','solicitud_de_cuota_alimenticia_a_persona_adulta_mayor_area_psicologica','solicitud_de_cuota_alimenticia_a_usuaria_area_psicologica','red_de_apoyo_area_psicologica','búsqueda_de_albergue_area_psicologica','seguimientos_presenciales_psicologicas','seguimiento_virtuales_psicologicas','otras_diligencias_area_psicologica','investigaciones_sociales','entrevista_a_mujer_detenida_area_social','número_de_atenciones_presenciales','número_de_atenciones_virtuales','redes_de_apoyo_area_social','entrevistas_realizadas','visitas_realizadas','acompañamiento_social','solicitudes_de_tratamitaciones_de_albergue_o_casas_de_acogida_area_social','informes_sociales','reportes_sociales','primeros_auxilios_psicológicos_area_social9','derivación_area_social','toma_de_denuncia_area_social','solicitud_de_medidas_area_social','solicitu_a_hijos_e_hijas_de_cuota_alimenticia_area_social','solicitud_de_cuota_alimenticia_a_persona_adulta_mayor_area_social','solicitud_de_cuota_alimenticia_a_usuaria_area_social','búsqueda_de_albergue_area_social','seguimientos_presenciales_sociales','seguimiento_virtuales_sociales','otras_diligencias_area_legal','sexo_indirecto','edad_indirecto','procedencia_indirecto','discapacidad_indirecto','orientación_sexual_indirecto','etnia_indirecto','nacionalidad_indirecto','expedientes_finalizados','mes','pad'],
    'psicologia':['fecha_de_asignacion_del_caso','caso_referido_por','asesorías','número_de_expediente','numero_de_dui,_n_ref_oficio/#_exp_unidad_de_servicio_a_la_persona_usuaria.','modalidad','sexo','edad','orientación_sexual','física','intelectual','visual','auditiva','psíquica','ninguna','nacionalidad','etnia','nivel_académico','mujeres_embarazdas','en_situación_de_desplazamiento','atención_psicológica_emergente','estudio_psicológico_especializado_para_la_niñez_y_adolescencia_bajo_medidas_de_protección','estudios_psicológicos_en_procesos_legales_administrativo_y/o_judicial','supervisión_de_resoluciones_administrativas_y_judiciales','intervenciones_psicoterapéuticas_especializadas_para_la_atención_de_niñez_y_adolescencia','psicología_clínica/tratamientos_psicoterapéuticos','programas_de_educacion_psicosocial','expediente_aperturado','reinicio','seguimiento','expedientes_finalizados','causas_de_finalización','resultado_favorable','formas_de_presentación_de_caso_finalizado','entrevistas_de_evaluación_y/o_tratamiento_psicológico','observación_y_registro_conductual','aplicación_de_prueba_psicológica_y/o_material_psicoterapeutico','calificación_de_prueba_psicológica_y/o_material_psicológico.','interpretación_de_prueba_psicológica_y/o_material_psicoterapéutico.','integración_y_analisis_de_resultados_de_la_evaluación_psicológica_o_del_proceso_psicoterapéutico.','discusión_de_casos','visitas_domiciliarias_y/o_institucionales','entrevistas_a_fuentes_colaterales','análisis_y_sistematización_de_la_finalización_del_caso','física_1','psicológica','sexual','económica','patrimonial','simbólica','feminicidio','derivado_a','reuniones_mensuales_para_formación_técnica','mes','pad']
}

urls_consolidados_x_uo={
    'familia':['https://docs.google.com/spreadsheets/d/e/2PACX-1vTShG0pKbNbr6uHx_TzuDPYjFJFASZXBuUOpwdoww4g8hlXN3cEUOuzNlv6P86ZZA/pub?gid=415266564&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQG2ouqVk8h9WnWQ_ireVaU6QMsf9eCyTJcU-TyAcnWHXRv62lGqm8VZ12qwYPQKg/pub?gid=996072723&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vR6cOtNRqiXzNewJFiP3bNH7uburKWmBprOnRZ6pQ6wlbYQMbxE5QCGIbuegUZWcg/pub?gid=605027961&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRStwibrGUymGrn4je7QK1nHu38GbcD1VCchikvXr4ZGj0pAGjTL10-qXapV6QxQw/pub?gid=1478393917&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQ_UTIAZ4RGZOzRWElW7NLd9Zdh6-7FsrESBqcCWNA8-cPN8ql-49pEq4hnKHVlmA/pub?gid=1031570767&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRcTg2RkT2oL1ujTtHPly8cPeJIbjBYq4ddNLNtzNkK5SBKieT0E-YzKYWFR9EC5Q/pub?gid=1397539810&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQHOZ58RLsvDr-QfJ_2aWvn_k0-eidPegXVDaICfuOinHegAWAsiXpEO4XZcCDFZA/pub?gid=1114368756&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTqmiHdH-J3M3so2PKdcUUBcaZK5mNFUsSBtal1dvR7cMXrr0ejWmmTTNmWwDUMOQ/pub?gid=57794625&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vT0ZKWjxyupOgSCHoQw_1xdByZc_Z91kg7Ihf4BtsvlJPvHBrdhmvxtV6HWmYT3bw/pub?gid=778809008&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTebSQgfPUmN9Voaa-gYcHVBRuX10UlxrPYZapihv1ZD57pkcttiFJQO-AKzNSLyw/pub?gid=1423049956&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRR_Bgg99fnO-6iFV-4g0Hnnq80XuBivqEX8f727ZaAnVrjjpuhIC9dE0Cy-wSsdA/pub?gid=1992712609&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRTrfaIx-VDrH2pycVD9B6FzgEOmnyGUIsn5mQsWD4piQ8ZWuVIpAoQdMZMbQ_N3Q/pub?gid=1972896472&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTjX9wZTeQ6sGVwjbj58rGaqppLA2nsZ8IqN5RGzMLuQiuitY1xyQ2zKlUqdFyEgw/pub?gid=442372642&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vSWaVL8Xcrh9soi-WeDWNLF0vPreeD0OfpzCCcfniazzHEWQlyRXwt6tzhd7f-F1A/pub?gid=1849342055&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTr7FKz4mvUuo8QErtxkGRPK636FchDbMCc42btcsH3mRS-u5GE_AVvLK9tidvKCA/pub?gid=448792471&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQYgZkusjdtLrvQ2BnfRrMjFHxiKOUsyRmRIRg2Btgxeaiu3FxQA6pWPq7hEyzzWA/pub?gid=730162062&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRBAphdUaww0PLfTiICsImeMa5BBLZtMTSipl-aXVPPmzfuujNu1BB-VTufBNna1w/pub?gid=1896661648&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vSNVEN7FYKf1w9CUUSP1EPy_KQLvjRsyLYY8MiKnvjsGLKTli87mzW-EG4XCs2F9g/pub?gid=62373719&single=true&output=tsv'],
    'nna':['https://docs.google.com/spreadsheets/d/e/2PACX-1vQvBP9o4ZnTF40GmLg-ONPkmVcIlHmvJkCJuW_BA4dhj984HxBkhIUruQB8mWsQdw/pub?gid=1671293608&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vS8j0JAexr_QuMCz5-_cITy3rE7zCMAkjEXMP9Mmlg2eVsfmZP49Mwym9Sz5e3Ibw/pub?gid=600867194&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRvVHYSYcy4-J2_qNLcTlOcaKpGLk-hcLd3NT_IiX56AovjCe3PECOrtCIsFhrK3g/pub?gid=2106871450&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRRQfJ7fq93y3eq-wCtzyGHVxjx6zZz3_OlwuDmrPYRnXs4TFjBCNcgK6-yRMX5ow/pub?gid=428395458&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTD8-1oHhD0ywWpM-LGpddumlL69KQYmsEFJmPXLoOrd7ElRortNPEJY_miPfuyUw/pub?gid=1371091798&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQJCCuFBS2iwkankKRGI-Ufpth86VwRe1WlPoi3rvRyNX3_qI8-8nkNVp7-whDUCw/pub?gid=1107471369&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRj5P1BnmiLAr_dRBB9yc0EziABy4GycpAldxTsoqw_Z13PRuD_RAj9-NvcInUHEg/pub?gid=2025029428&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQWqC8xJJgy8lprhTQN-yTno29sPv5NqCG7GZb_Pf44pie9UjimaG7MygSoy5mbnQ/pub?gid=1925582772&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRKQ345VCbIe-ud7uLcxxZiZ-9haOiCFg9wL_kaYshm5L8_oVrMaApjeYKi8OhPtg/pub?gid=94343033&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTl0iwZESpavfpZbxPfXFLvtpgUyrQdiiYfeaLeR0a70GG1Tlk0MCinDVi8YsMkyg/pub?gid=1008959767&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQZaZw5pZ1qTpPj8Zsa1BfcDVaGTr1KPqGFyA0yR3ARA8_oFAXj1jN3C9JoFmET8A/pub?gid=1819714490&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQEHPCmFQfN0qWy5YbBhbx-4MTAh6avnfQDF6jdWcMfwW41h8xZKvAKi4WIRMnMNQ/pub?gid=942275905&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQsZ0aqbgTKNUV9WT-S-oclme1Kclbr1Y9RA7oreILxtZySpGVthKTNjMhHIjkmhQ/pub?gid=194813598&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRyt9Ol_bGX2y43Fsl45PUbaAfta60YSspiPThVrtZtbAvUTt1dta3cYZhNKqEAuw/pub?gid=41665064&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQHsB_fcp9-ouakjuFtFXwVHNR_3MBv6A2DR5sMyYwwRcVmn5zrubZ9GVUqg68itA/pub?gid=795271833&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQky44e3uGBeIoitJePBMsk0QRZE35Y5bsB-RUVed0Fl5rVFOpBVfoLYLcrQnCIGA/pub?gid=327170876&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQKihMjTOPhhefHirxdObWHcpqXonN7Hz-ZwxjFo3pksO0PUK3hgcZluEyENTnrdw/pub?gid=1393361068&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTTmf1wLANQZaiMdUmpAm2qEMM07dpOKHRcQ49an88qSWJ7_4fSyH0ktT-uHK-Y_w/pub?gid=1100739936&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQQtSqqAfiY49QT0MLuXRbojZs1Qhf_h6b0zekOPAbVV9IQ68uqYLB3_FoEt4XyCw/pub?gid=747157420&single=true&output=tsv'],
    'mediacion':['https://docs.google.com/spreadsheets/d/e/2PACX-1vSzlTaAn8_BRe1BANGQtyPIJw7ATcl8SpHZZ8YaW-C5or_b8q7_BX8XozbFY7Zg0Q/pub?gid=198454733&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRuGWbIseNKFNrwRFj0VpIZONT5CvrSZrDBLPS_OuXy1GmdxcOAydyPbQFi3z7ioA/pub?gid=1189385927&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTBkvBU_g7411ryorjnIxFjU8F3UPmfHf3LiVErWNb0J6rB-MjIceIWkWo5Lj2_ww/pub?gid=784666252&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQHbDyNyy7uJ_fhWnipdwQVx5EiDuJ7IDzmQ5MfjhmIBc9cAP18FwZ61XAEJ3gXCg/pub?gid=297833478&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRJV3WXPIz0C0LYKfCONP8C2orD2kqT0wi2wAUcB0gQsJBXqDpd0khYc-7hzGzBlA/pub?gid=1862454337&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vSrY6BP40cQcLv2XXZj7ckxmlhlLSlFyDTWJ4llT7T7odeJkWUk_nCj-LHvfu_4Xw/pub?gid=611353005&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRB45yTMAS440ra0lGOfET_yTOVk-RkVzNhXpQLjGRpqfv3EnHzFY0UsprRDYN7bg/pub?gid=795917884&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRwt75syWV7503B-QGdQJaV_TEtALoE1MwvQCLM59T6ns_C5Nzxpdn-SQzHa7VGvQ/pub?gid=505275965&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vS5mXMIKau-4VnAM-kcTQE6lpXGswmvBs_NUx7y4Ky9QawyPYeA4THvQbalRU5IYw/pub?gid=1857719332&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vSACRdVUT3Ttyfdo3sJAPnciVRLL8fsH7MBsaNy_Emtecg3rShHKTMcpSgimykODw/pub?gid=1609565731&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTfSnh1f4DYvJzv5StiJAvi7wGz0Szh6UQNBUiwfizBS5S0nQU_YihKDCM8gE-SZg/pub?gid=1418735584&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vSPEIoruYf2aSVuOd8KcP0obkKozbvfKUFETH93fjdwkMKOIBMK3VZuRbo7Iz5uug/pub?gid=728260275&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQAcaHoBfgeNLkQND1mKH76IIHbL28b4xtQJxpw-covfvAUc5mjf6jaqc0abZMAdQ/pub?gid=1028152609&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTNrG7EIRb8hgAUPkYKPtEiYwmeIw56FeUHbUT9IhDrILoxPeyTTqp_WqRdibqzyQ/pub?gid=2087531253&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRfOmB7tvwIJeRrTIL4rKMFW6J0Ckh8VPWRh19Vx0bh2zUY-nxj-tAv_eQwZx_uJg/pub?gid=228550943&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRxf2x8LnZ503IYy0nZmq0v1RVDrmY5Gmsh5na9IFufNnM3sX1GFccll09TRqe_UA/pub?gid=486353213&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTvOscQZsGOw9o5cg6KznoeyOLZ0v2gqjB6-14y3pbUkIhyc6fkP8KCsNDN_8FcSw/pub?gid=845664066&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRhA5ZeR5s8SrNBPdKByUG6DPJQMa1EWjSHMKGA2VDTP0QToc9H5XaEsghHhMQZ5w/pub?gid=1598500854&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQpdZEQr4FW1pKzjbBJHc5pFW6jT5MfigDsGlI1ZS3mQi-rp6lgkkBOblOT9Wvvyw/pub?gid=1966337665&single=true&output=tsv'],
    'uaem':['https://docs.google.com/spreadsheets/d/e/2PACX-1vR0KAaDZckGISdrwYBS24l6MbaPbofNZQvPChot0diL6GF_BTbe9aX8VFyL0kGIgA/pub?gid=1810824023&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vSLPxY_D5BM3F7weVSpKhs9EGFNzXTR81Yiq2Lb3z1Gq_xouVWZAChNs3D4QzkkNQ/pub?gid=1286517242&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQZEHhYgtI155i_e56HELlr5RKObz1ns2u0od5x7C_6CpQWwfnDhKq2o7_Ykvr8Cg/pub?gid=825105003&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQQKP0IF5TrXMaEgzSp3ll9cUGwhyRAarFfvv1_dhN0BUvO2RzQHkp-pBJSNxFqTg/pub?gid=1179367220&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQ-UwRlWvbVwcGL3Pu3On7GlePLNHYuN9G59wIW6xuGInBNyjN2P5GIyA1CHO42hQ/pub?gid=1949566846&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vSrADUBhjPkIdPALMyhCerl_m9AmAyWq5s_ZETqIsdWmlpezHkcdi7W2LoEh8HRSQ/pub?gid=1202596275&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRGkY0CyIm_xRyeDESxRXFY4Q0Nn0Nnxzf9jJzOBgFJBg11hDZS-Ch7R_An9Ri89A/pub?gid=932358574&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQoHLMF-jcv2az8GhkrVyC1bw9nx_oCps4Cubm2u0RfGhj0z7jQXr9qBnTJTjcmCg/pub?gid=921761681&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRIURtyY7y4lNNQphkFkNeiWj0a340BD_XHBtbiOEP0e6eeLSywjrkhrYvf22XhRA/pub?gid=582487302&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vSpOzz-OwwZmZS-WndQypBbZ0MUDAUUBlQuPVGXWf6xPGXb3i6to5h-7qFf-kIroQ/pub?gid=1263319460&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQUjopAQnTXw7yXU-CC1upUA_2hhaiMg27pMt4tM1_P9Ax68MVnvh-Z12HQsiBYGA/pub?gid=1215273514&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTIOkPJ4t8QIibt42M1qwScE37_qVmq29a8z-Wi49Fx3m-RgZ4WUz_DczMCauawbw/pub?gid=1696619675&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRA5Ueq4jieJBtjOuXefBmoeN24fl3Ug9D1sbUciXx_TXAt2nWx33NZAwavkfGnTA/pub?gid=853643514&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTAW3VnHrUU21u3ymavzqbSgYtmCFR-RKmKRwcoH9uqW9SlNITptcTD0Ep5fGBEAQ/pub?gid=931950124&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTauJpyi0pExqHGaxEaAb7C0BrjJUyqW4zg1oEidZQhjflyRHtdnA6sscy2RgXPDg/pub?gid=514800644&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQMMRYW3pu6LDrPo6kTEGLohKkvpKRSu2eyr2Dn0uMT1NlugF7ArcrSkhjG1vPceQ/pub?gid=306989291&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRRtBYx_hMJfzD2y10blFLMq96ooP5-HfFDhS8MbnUoYhtAioRCo5YYo4GCY4tYVg/pub?gid=238757453&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQRIZ9Y-uuM0k784CCYgdR_s2GNi8hBohIx_bRiFnKibPbvPF323FWJgBFioacQww/pub?gid=1195260798&single=true&output=tsv'],
    'psicologia':['https://docs.google.com/spreadsheets/d/e/2PACX-1vTPlvKF8c2Be5RTYCs7EuyitCuf14799tsIasoRqRnsNucWic5Kl-rsGqez9PASjzwYYLn-suTkRv6E/pub?gid=0&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vSFH3y92pZLRvFjz1P-WDikf01tJAOgE2PqIRvKquEBnbQXalnbkEPSOFvPM0snMQ/pub?gid=893492184&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQvlxxOk0uBLQE-KrwweygEzGgcMa_QoY3of_6KZeiQCOx8wtG7c5D56J5Ef_Eocw/pub?gid=1976474398&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQuKD4CV5bba_jtv1zEqPR_jsytCw423-wF8GMQr7Gi9yYKwoF9_e4dldL3jtr-Lg/pub?gid=104882873&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTrA5k7jOs-bHeSWR1Q3CfYojgjS5LqMJGEyXcrmKwrLooMv_TxuNXjpUPX-e95jg/pub?gid=2061916279&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRsU7BsJY4OTcMirQgvz5DSKP_wUqh5r4fhL26REhyk8vuWqxAo7U3qqMLc7TwiLw/pub?gid=1945621058&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQ1xTOC8k2WBIC652Zt6CFG-jqOU-gDiItBm3dpl0-LYLdEW8G-hYRkIkh5J8dRIQ/pub?gid=173043107&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vRIPhTEOkwQozwh7sj8uv7Yr02NTr3Pm8QXElvsgTWFhb4iH-LSswcBybs9eRZkkg/pub?gid=10387589&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vSqcE94RtwDJ2oh0UgplPumgI1TwGzuNNzchhOGvl5ThPa115BEdk9qJ3H4dCZwlg/pub?gid=445190087&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTWQ4Ple4jIgTCHuT76EN1yBpAdHvES5JaTWZ5briiR4pOkHchx9JQWsbWKF7nvOg/pub?gid=1839602856&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTsXqhWow2xC7bxi7QxzTMfwggCSy701ArPtXrs1LDzfkT3C_VwC50YIz_qmQFVWw/pub?gid=959951100&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vSBIC0moZQEmtlzS4nborS16UpDxQuU_q5L8-jJh1TXv2McVshKpHlRWG4F9LCVSA/pub?gid=1491951453&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQgSk-PxyopTFwpe-wdr_vLE61Y7ib6Fi8cPiGuEp04ji8tnsB_edWxFUJ9qfqRuA/pub?gid=1115165669&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQULyOpHQVUdqPgE0syEAu-tmDnO9WR5UiXza_uDyOhwtCZUYbEY3ABbJoy4rzqMg/pub?gid=816016346&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vST-gNogwvB92i96zNYDGxTG6HIdS4_zqARzeodidv2NO9xzG7Brmqc1MxlfvJghQ/pub?gid=1056730714&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vSuVej_wTwmEsSnOLqDZrP8wLVcD0vg2hUYNceb1LN1bSP26HgiJ7fZ3h2a-QhlnA/pub?gid=1389458828&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vQm1sxQm3hCYYs8-hXfjEZh3j4FGxTSo3MOwXe8E3uyzN4FNv1VSfc73UHPNGmsCg/pub?gid=678797341&single=true&output=tsv','https://docs.google.com/spreadsheets/d/e/2PACX-1vTWGMgcV4Dxz5fT4_VB6emHQRzA3CRTq1QGT2RwiRkfi0PFQBGTfwBRYCUeMu6xjg/pub?gid=180585574&single=true&output=tsv']
}

for uo in urls_consolidados_x_uo:
  df[uo] = pd.concat([pd.read_csv(url,sep='\t',names=headers[uo]) for url in urls_consolidados_x_uo[uo]])
  filter = df[uo]['mes'].notna()
  df[uo] = df[uo][filter]
  df[uo]['mes'] = df[uo]['mes'].str.strip()
  df[uo]['pad'] = df[uo]['pad'].str.strip()
  ####### exports ##################
  #df[uo].to_excel(f"{uo}_2024.xlsx",index=False)
  df[uo].to_sql(f"{uo}_2024",engine, if_exists='append', index=False, chunksize=100)
  #df[uo].to_csv(f"{uo}_2024.tsv",sep="\t",index=False)
  #df[uo].to_json(f"{uo}_2024.json",orient='records',index=False)
